<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–±–º–µ–Ω–∞ - Doverka & Broker</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=10">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <span class="logo-icon">üßÆ</span>
                <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–±–º–µ–Ω–∞</h1>
            </div>
            <div class="subtitle">RUB ‚Üî THB ‚Üî USDT | v5 –¢–û–ß–ù–´–ï –ö–£–†–°–´</div>
        </header>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ—Ç–æ–¥–∞ -->
        <div class="method-switcher">
            <button class="method-btn active" data-method="doverka" onclick="switchMethod('doverka')">
                üè¶ Doverka (SBP)
            </button>
            <button class="method-btn" data-method="broker" onclick="switchMethod('broker')">
                üíº –ë—Ä–æ–∫–µ—Ä
            </button>
        </div>

        <!-- –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫—É—Ä—Å (—Ç–æ–ª—å–∫–æ –¥–ª—è –±—Ä–æ–∫–µ—Ä–∞) - –ü–ï–†–ï–ù–ï–°–ï–ù–û –í–í–ï–†–• -->
        <div id="customRateSection" class="custom-rate-top" style="display: none;">
            <div class="custom-rate-card">
                <label class="input-label">üíº –£–°–¢–ê–ù–û–í–ò–¢–¨ –ö–£–†–° –ë–†–û–ö–ï–†–ê RUB-USDT</label>
                <div class="input-wrapper">
                    <input type="text" id="customRubUsdt" class="amount-input" value="80.90" oninput="updateCustomRate(); hideResults()">
                    <span class="input-currency">‚ÇΩ</span>
                </div>
            </div>
        </div>

        <!-- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã -->
        <div class="rates-card" id="ratesCard">
            <div class="rates-header">
                <span class="rates-title">üìä –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã</span>
                <button class="refresh-btn" id="refreshBtn" onclick="refreshRates()">
                    <span class="refresh-icon">‚Üª</span> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            <div class="rates-grid">
                <div class="rate-item">
                    <div class="rate-label">USDT-THB (Binance)</div>
                    <div class="rate-value" id="usdtThbRate">31.16 ‡∏ø</div>
                </div>
                <div class="rate-item">
                    <div class="rate-label" id="rubUsdtLabel">RUB-USDT (Doverka)</div>
                    <div class="rate-value" id="rubUsdtRate">84.23 ‚ÇΩ</div>
                </div>
                <div class="rate-item highlight">
                    <div class="rate-label">–ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫—É—Ä—Å</div>
                    <div class="rate-value" id="estimatedRate">~2.79 ‚ÇΩ/‡∏ø</div>
                </div>
            </div>
            <div class="rates-updated" id="ratesUpdated">
                –û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="updateTime">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
        </div>

        <!-- –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±–º–µ–Ω–∞ -->
        <div class="scenarios-grid">
            <!-- Doverka —Å—Ü–µ–Ω–∞—Ä–∏–∏ -->
            <button class="scenario-btn active" data-method="doverka" data-scenario="rub-to-thb" onclick="switchScenario('rub-to-thb')">
                <span class="scenario-icon">üí∞</span>
                <div class="scenario-title">RUB ‚Üí THB</div>
            </button>
            <button class="scenario-btn" data-method="doverka" data-scenario="thb-to-rub" onclick="switchScenario('thb-to-rub')">
                <span class="scenario-icon">üí∏</span>
                <div class="scenario-title">THB ‚Üê RUB</div>
            </button>

            <!-- Broker —Å—Ü–µ–Ω–∞—Ä–∏–∏ -->
            <button class="scenario-btn" data-method="broker" data-scenario="rub-to-thb" style="display: none;" onclick="switchScenario('rub-to-thb')">
                <span class="scenario-icon">üí∞</span>
                <div class="scenario-title">RUB ‚Üí THB</div>
            </button>
            <button class="scenario-btn" data-method="broker" data-scenario="thb-to-usdt" style="display: none;" onclick="switchScenario('thb-to-usdt')">
                <span class="scenario-icon">üíé</span>
                <div class="scenario-title">THB ‚Üí USDT</div>
            </button>
            <button class="scenario-btn" data-method="broker" data-scenario="usdt-to-thb" style="display: none;" onclick="switchScenario('usdt-to-thb')">
                <span class="scenario-icon">üîÑ</span>
                <div class="scenario-title">USDT ‚Üí THB</div>
            </button>
            <button class="scenario-btn" data-method="broker" data-scenario="rub-to-usdt" style="display: none;" onclick="switchScenario('rub-to-usdt')">
                <span class="scenario-icon">üíµ</span>
                <div class="scenario-title">RUB ‚Üí USDT</div>
            </button>
        </div>

        <!-- –§–æ—Ä–º–∞ —Ä–∞—Å—á–µ—Ç–∞ -->
        <div class="calculator-card">
            <div class="input-section">
                <!-- –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ë—Ä–æ–∫–µ—Ä–∞) -->
                <div class="direction-switcher" id="directionSwitcher" style="display: none; margin-bottom: 20px;">
                    <div class="direction-header">üéØ –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</div>
                    <div class="direction-buttons">
                        <button class="direction-btn active" data-direction="amount" onclick="setDirection('amount')">
                            üí∞ –í–Ω–æ—à—É —Å—É–º–º—É
                        </button>
                        <button class="direction-btn" data-direction="target" onclick="setDirection('target')">
                            üéØ –•–æ—á—É –ø–æ–ª—É—á–∏—Ç—å
                        </button>
                    </div>
                </div>

                <label for="amount" class="input-label" id="inputLabel">
                    –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤ —Ä—É–±–ª—è—Ö (‚ÇΩ)
                </label>
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        id="amount" 
                        class="amount-input" 
                        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 100000"
                        oninput="formatInput(this); hideResults()"
                        onkeydown="if(event.key === 'Enter') calculate()"
                    >
                    <span class="input-currency" id="inputCurrency">‚ÇΩ</span>
                </div>

                <div class="calculate-action">
                    <button class="calculate-btn" id="calculateBtn" onclick="calculate()">
                        üöÄ –†–ê–°–°–ß–ò–¢–ê–¢–¨
                    </button>
                </div>

                <!-- –ë–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–°–∫–∏–¥–∫–∏ –∏ –ü–∞—Ä—Ç–Ω–µ—Ä) –ü–û–î –∫–Ω–æ–ø–∫–æ–π –†–ê–°–°–ß–ò–¢–ê–¢–¨ -->
                <div class="calculator-settings" style="margin-top: 25px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
                    <!-- –°–∫–∏–¥–∫–∏ -->
                    <div id="commissionLevelSection" class="commission-level-section">
                        <div class="discount-header">
                            <label class="checkbox-label">
                                <input type="checkbox" id="applyDiscount" onchange="toggleDiscount()">
                                <span class="checkbox-text">üéÅ –°–¥–µ–ª–∞—Ç—å —Å–∫–∏–¥–∫—É (–∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–±—ã–ª—å)</span>
                            </label>
                        </div>
                        
                        <div id="profitMarginWrapper" style="display: none; margin-top: 15px;">
                            <label class="input-label">üí∞ –ñ–µ–ª–∞–µ–º–∞—è –ø—Ä–∏–±—ã–ª—å</label>
                            <div class="commission-buttons profit-steps">
                                <button class="commission-btn" data-profit="1.5" onclick="setProfitMargin(1.5)">1.5%</button>
                                <button class="commission-btn" data-profit="2.0" onclick="setProfitMargin(2.0)">2%</button>
                                <button class="commission-btn" data-profit="2.4" onclick="setProfitMargin(2.4)">2.4%</button>
                                <button class="commission-btn" data-profit="3.0" onclick="setProfitMargin(3.0)">3%</button>
                                <button class="commission-btn" data-profit="3.5" onclick="setProfitMargin(3.5)">3.5%</button>
                                <button class="commission-btn active" data-profit="4.0" onclick="setProfitMargin(4.0)">4%</button>
                                <button class="commission-btn" data-profit="4.5" onclick="setProfitMargin(4.5)">4.5%</button>
                                <button class="commission-btn" data-profit="5.0" onclick="setProfitMargin(5.0)">5%</button>
                            </div>
                        </div>
                    </div>

                    <!-- –ü–∞—Ä—Ç–Ω–µ—Ä -->
                    <div class="partner-section" style="margin-top: 20px;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="hasPartner" onchange="togglePartner()">
                            <span class="checkbox-text">üë• –ï—Å—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä?</span>
                        </label>
                        <div id="partnerPercentWrapper" style="display: none; margin-top: 15px;">
                            <label class="input-label">ü§ù % –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (–æ—Ç –ø—Ä–∏–±—ã–ª–∏)</label>
                            <div class="input-wrapper small">
                                <input type="text" id="partnerPercent" class="amount-input" value="50" oninput="hideResults()">
                                <span class="input-currency">%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calculate-action">
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="results-section" id="resultsSection" style="display: none;">
                <div class="result-main">
                    <div class="result-label" id="resultLabel">–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç:</div>
                    <div class="result-value" id="resultValue">0 ‡∏ø</div>
                    <div class="result-rate">
                        –ö—É—Ä—Å: <span id="finalRate">0</span> <span id="rateCurrency">‚ÇΩ/‡∏ø</span>
                    </div>
                </div>

                <div class="details-section">
                    <div class="details-header" onclick="toggleDetails()">
                        <span>üìã –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞</span>
                        <span class="toggle-icon" id="toggleIcon">‚ñº</span>
                    </div>
                    <div class="details-content" id="detailsContent">
                        <!-- –î–µ—Ç–∞–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="info-card">
            <div class="info-header" onclick="toggleInfo()">
                <span>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span>
                <span class="toggle-icon" id="infoToggleIcon">‚ñº</span>
            </div>
            <div class="info-content" id="infoContent">
                <div class="info-note">
                    <strong>–†–µ–∂–∏–º Doverka (SBP):</strong> –†–µ–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –æ—Ç API –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                </div>
                <div class="info-note">
                    <strong>–†–µ–∂–∏–º Broker:</strong> –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫—É—Ä—Å RUB-USDT + –≤—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –∫–æ–º–∏—Å—Å–∏–π
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>–†–∞—Å—á–µ—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö –∫—É—Ä—Å–∞—Ö</p>
            <p class="footer-small">–í—Å–µ —Ä–∞—Å—á–µ—Ç—ã —è–≤–ª—è—é—Ç—Å—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–º–∏</p>
        </footer>
    </div>

    <script src="calculator.js?v=20"></script>
    <script>
        // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π:');
        console.log('switchMethod:', typeof switchMethod);
        console.log('switchScenario:', typeof switchScenario);
        console.log('setCommissionLevel:', typeof setCommissionLevel);
        console.log('updateCustomRate:', typeof updateCustomRate);
        
        // –¢–µ—Å—Ç –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            console.log('‚úÖ DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('–ö–Ω–æ–ø–∫–∏ –º–µ—Ç–æ–¥–∞:', document.querySelectorAll('.method-btn').length);
            console.log('–ö–Ω–æ–ø–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:', document.querySelectorAll('.scenario-btn').length);
            console.log('–ö–Ω–æ–ø–∫–∏ –∫–æ–º–∏—Å—Å–∏–π:', document.querySelectorAll('.commission-btn').length);
        });
    </script>
</body>
</html>

